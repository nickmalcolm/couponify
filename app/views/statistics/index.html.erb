<% content_for(:head) do %>
  <%= javascript_include_tag "jqplot/plugins/jqplot.pieRenderer.min"  %>
<% end %>
<h2>Statistics</h2>
<table id="discounts">
  <tbody>
    <caption>Discounts Generated</caption>
    <thead>
      <td>
      </td>
      <th scope="col">
        Discounts
      </th>
    </thead>
    <tr>
      <th scope="row">
        Used
      </th>
      <td>
        <%= @used.count+1 %>
      </td>
    </tr>
    <tr>
      <th scope="row">
        Unused
      </th>
      <td>
        <%= @unused.count %>
      </td>
    </tr>
  </tbody>
</table>

<div style="width:420px;height:300px" id="pie_dish" class=""></div>

<% content_for(:jquery) do %>
  jQuery.jqplot('pie_dish', 
    [[['Used', <%= @used.count+10 %>], ['Unused', <%= @unused.count+10 %> ]]], 
    {
      title: ' ', 
      seriesDefaults: {shadow: false, renderer: jQuery.jqplot.PieRenderer, rendererOptions: { sliceMargin: 4, showDataLabels: true } }, 
      legend: { show:true }
    }
  );
<% end %>